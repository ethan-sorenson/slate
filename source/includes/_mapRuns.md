# Map Runs

The Map Run endpoints can be used to run maps in SmartConnect. Upon completion of the map run in SmartConnect, the web service will respond with a status message.

## Run Map Properties

Attribute | Type | Description
--------- | ------- | -----------
ErrorCount | integer | Number of failed records
Errors | data-table | XMl data table, populated when a record fails
MapDescription | string | Map Description field for the process
MapKey | guid | Unique identifier for the process
MapId | string | Map Id field for the process
RecordCount | integer | Number of records processed in run
RunNumber | integer | Run number
Status | boolean | 0 = success, 1 = failure
ErrorMessage | string | Last Error Message from the run

## RunMap

> To run a specified process, use this code:

```shell
curl POST "{{API Url}}/runmap?token={{Token}}&mapKey={{mapKey}}" \
  -H 'Content-Type: application/x-www-form-urlencoded' \
  -H 'Accept: application/json' 
```

```python
import requests

url = "{{API Url}}/runmap?token={{Token}}&mapKey={{mapKey}}"
headers = {
  'Content-Type': 'application/x-www-form-urlencoded',
  'Accept': 'application/json'
}

response = requests.request("POST", url, headers=headers)

print(response.text.encode('utf8'))
```

> The above command returns JSON structured like this:

```json
{
    "ErrorCount": 1,
    "Errors": "",
    "MapDescription": "Import of Purchase Journal",
    "MapKey": "364fde19-0748-4d10-886f-a95300a506c5",
    "MapId": "EXCEL TO BUSINESS CENTRAL PURCHASE JOURNAL",
    "RecordCount": 1,
    "RunNumber": 80,
    "Status": 1,
    "ErrorMessage": "Document was not sent due to document errors."
```

> The errors field will contain an XML Data Table:

```xml
<NewDataSet>\r\n  
    <xs:schema id=\"NewDataSet\"
        xmlns=\"\"
        xmlns:xs=\"http://www.w3.org/2001/XMLSchema\"
        xmlns:msdata=\"urn:schemas-microsoft-com:xml-msdata\">\r\n    
        <xs:element name=\"NewDataSet\" msdata:IsDataSet=\"true\" msdata:MainDataTable=\"ErrorTable\" msdata:UseCurrentLocale=\"true\">\r\n      
            <xs:complexType>\r\n        
                <xs:choice minOccurs=\"0\" maxOccurs=\"unbounded\">\r\n          
                    <xs:element name=\"ErrorTable\">\r\n            
                        <xs:complexType>\r\n              
                            <xs:sequence>\r\n                
                                <xs:element name=\"accountnumber\" type=\"xs:string\" minOccurs=\"0\" />\r\n                
                                <xs:element name=\"CustomerID\" type=\"xs:string\" minOccurs=\"0\" />\r\n                
                                <xs:element name=\"name\" type=\"xs:string\" minOccurs=\"0\" />\r\n                
                                <xs:element name=\"EONERUNERRORS\" type=\"xs:string\" minOccurs=\"0\" />\r\n              
                            </xs:sequence>\r\n            
                        </xs:complexType>\r\n          
                    </xs:element>\r\n        
                </xs:choice>\r\n      
            </xs:complexType>\r\n    
        </xs:element>\r\n  
    </xs:schema>\r\n  
    <ErrorTable>\r\n    
        <accountnumber>C0008</accountnumber>\r\n    
        <CustomerID>IDs</CustomerID>\r\n    
        <name>Test Account 008</name>\r\n    
        <EONERUNERRORS>Document was not sent due to document errors.</EONERUNERRORS>\r\n  
    </ErrorTable>\r\n
    <ErrorTable>\r\n    
        <accountnumber>C0007</accountnumber>\r\n    
        <CustomerID>IDs</CustomerID>\r\n    
        <name>Test Account 007</name>\r\n    
        <EONERUNERRORS>Document was not sent due to document errors.</EONERUNERRORS>\r\n  
    </ErrorTable>\r\n
</NewDataSet>
```

This endpoint runs the specified process.

### HTTP Request

`POST {{API Url}}/runmap?token={{Token}}&mapKey={{mapKey}}`

### Query Parameters

Parameter | Required | Description
--------- | ------- | -----------
token | true | Token generated by the GetToken endpoint
mapKey | true | Unique identifier for the process to retrieve


<aside class="warning">Currently this endpoint only returns the errors as an XML data table</aside>

## RunMapWithVariables

> To run a specified process and provide Global Variables, use this code:

```shell
curl POST "{{API Url}}/RunMapWithVariables?token={{Token}}&mapKey={{mapKey}}" \
  -H 'Content-Type: application/json' \
  -H 'Accept: application/json' 
  -d '[
       {
         "Key": "GBL_TEST",
         "Value": "107210"
        },
      {
         "Key": "GBL_TEST2",
         "Value": "Sample"
       }
     ]'
```

```python
import requests

url = "{{API Url}}/RunMapWithVariables?token={{Token}}&mapKey={{mapKey}}"
headers = {
  'Content-Type': 'application/json',
  'Accept': 'application/json'
}
payload = 
[
    {
        "Key": "GBL_TEST",
        "Value": "107210"
    },
    {
        "Key": "GBL_TEST2",
        "Value": "Sample"
    }
]

response = requests.request("POST", url, headers=headers, data = payload)

print(response.text.encode('utf8'))
```

> The above command returns JSON structured like this:

```json
{
    "ErrorCount": 1,
    "Errors": "",
    "MapDescription": "Import of Purchase Journal",
    "MapKey": "364fde19-0748-4d10-886f-a95300a506c5",
    "MapId": "EXCEL TO BUSINESS CENTRAL PURCHASE JOURNAL",
    "RecordCount": 1,
    "RunNumber": 80,
    "Status": 1,
    "ErrorMessage": "Document was not sent due to document errors."
```

> The errors field will contain an XML Data Table:

```xml
<NewDataSet>\r\n  
    <xs:schema id=\"NewDataSet\"
        xmlns=\"\"
        xmlns:xs=\"http://www.w3.org/2001/XMLSchema\"
        xmlns:msdata=\"urn:schemas-microsoft-com:xml-msdata\">\r\n    
        <xs:element name=\"NewDataSet\" msdata:IsDataSet=\"true\" msdata:MainDataTable=\"ErrorTable\" msdata:UseCurrentLocale=\"true\">\r\n      
            <xs:complexType>\r\n        
                <xs:choice minOccurs=\"0\" maxOccurs=\"unbounded\">\r\n          
                    <xs:element name=\"ErrorTable\">\r\n            
                        <xs:complexType>\r\n              
                            <xs:sequence>\r\n                
                                <xs:element name=\"accountnumber\" type=\"xs:string\" minOccurs=\"0\" />\r\n                
                                <xs:element name=\"CustomerID\" type=\"xs:string\" minOccurs=\"0\" />\r\n                
                                <xs:element name=\"name\" type=\"xs:string\" minOccurs=\"0\" />\r\n                
                                <xs:element name=\"EONERUNERRORS\" type=\"xs:string\" minOccurs=\"0\" />\r\n              
                            </xs:sequence>\r\n            
                        </xs:complexType>\r\n          
                    </xs:element>\r\n        
                </xs:choice>\r\n      
            </xs:complexType>\r\n    
        </xs:element>\r\n  
    </xs:schema>\r\n  
    <ErrorTable>\r\n    
        <accountnumber>C0008</accountnumber>\r\n    
        <CustomerID>IDs</CustomerID>\r\n    
        <name>Test Account 008</name>\r\n    
        <EONERUNERRORS>Document was not sent due to document errors.</EONERUNERRORS>\r\n  
    </ErrorTable>\r\n
    <ErrorTable>\r\n    
        <accountnumber>C0007</accountnumber>\r\n    
        <CustomerID>IDs</CustomerID>\r\n    
        <name>Test Account 007</name>\r\n    
        <EONERUNERRORS>Document was not sent due to document errors.</EONERUNERRORS>\r\n  
    </ErrorTable>\r\n
</NewDataSet>
```

This endpoint runs the specified process. If the process is using Global Variables, then the default value for those variables can be provided in the body of the request.

### HTTP Request

`POST {{API Url}}/RunMapWithVariables?token={{Token}}&mapKey={{mapKey}}`

### Query Parameters

Parameter | Required | Description
--------- | ------- | -----------
token | true | Token generated by the GetToken endpoint
mapKey | true | Unique identifier for the process to retrieve


<aside class="warning">Currently this endpoint only returns the errors as an XML data table</aside>

## RunMapDataTable

> To run a specified process with provided source data, use this code:

```shell
curl POST "{{API Url}}/RunMapDataTable?token={{Token}}&mapKey={{mapKey}}" \
  -H 'Content-Type: text/xml' \
  -H 'Accept: application/json' 
  -d '<RequestData>
        <Table> 
          <accountnumber>C0007</accountnumber> 
          <CustomerID>IDs</CustomerID> 
          <name>Test Account 007</name> 
        </Table> 
      </RequestData>'
```

```python
import requests

url = "{{API Url}}/RunMapDataTable?token={{Token}}&mapKey={{mapKey}}"
headers = {
  'Content-Type': 'text/xml',
  'Accept': 'application/json'
}
payload = 
" <RequestData>
    <Table> 
      <accountnumber>C0007</accountnumber> 
      <CustomerID>IDs</CustomerID> 
      <name>Test Account 007</name> 
    </Table> 
  </RequestData>
"

response = requests.request("POST", url, headers=headers, data = payload)

print(response.text.encode('utf8'))
```

> The above command returns JSON structured like this:

```json
{
    "ErrorCount": 1,
    "Errors": "",
    "MapDescription": "Import of Purchase Journal",
    "MapKey": "364fde19-0748-4d10-886f-a95300a506c5",
    "MapId": "EXCEL TO BUSINESS CENTRAL PURCHASE JOURNAL",
    "RecordCount": 1,
    "RunNumber": 80,
    "Status": 1,
    "ErrorMessage": "Document was not sent due to document errors."
```

This endpoint runs the specified process with the provided XML data table.

### HTTP Request

`POST {{API Url}}/RunMapDataTable?token={{Token}}&mapKey={{mapKey}}`

### Query Parameters

Parameter | Required | Description
--------- | ------- | -----------
token | true | Token generated by the GetToken endpoint
mapKey | true | Unique identifier for the process to retrieve


<aside class="warning">Currently this endpoint only returns the errors as an XML data table</aside>

## RunMapDataTableWithErrors

> To run a specified process with provided source data, use this code:

```shell
curl POST "{{API Url}}/RunMapDataTableWithErrors?token={{Token}}&mapKey={{mapKey}}" \
  -H 'Content-Type: text/xml' \
  -H 'Accept: application/json' 
  -d '<RequestData>
        <Table> 
          <accountnumber>C0007</accountnumber> 
          <CustomerID>IDs</CustomerID> 
          <name>Test Account 007</name> 
        </Table> 
      </RequestData>'
```

```python
import requests

url = "{{API Url}}/RunMapDataTableWithErrors?token={{Token}}&mapKey={{mapKey}}"
headers = {
  'Content-Type': 'text/xml',
  'Accept': 'application/json'
}
payload = 
" <RequestData>
    <Table> 
      <accountnumber>C0007</accountnumber> 
      <CustomerID>IDs</CustomerID> 
      <name>Test Account 007</name> 
    </Table> 
  </RequestData>
"

response = requests.request("POST", url, headers=headers, data = payload)

print(response.text.encode('utf8'))
```

> The above command returns JSON structured like this:

```json
{
    "ErrorCount": 1,
    "Errors": "",
    "MapDescription": "Import of Purchase Journal",
    "MapKey": "364fde19-0748-4d10-886f-a95300a506c5",
    "MapId": "EXCEL TO BUSINESS CENTRAL PURCHASE JOURNAL",
    "RecordCount": 1,
    "RunNumber": 80,
    "Status": 1,
    "ErrorMessage": "Document was not sent due to document errors."
```

> The errors field will contain an XML Data Table:

```xml
<NewDataSet>\r\n  
    <xs:schema id=\"NewDataSet\"
        xmlns=\"\"
        xmlns:xs=\"http://www.w3.org/2001/XMLSchema\"
        xmlns:msdata=\"urn:schemas-microsoft-com:xml-msdata\">\r\n    
        <xs:element name=\"NewDataSet\" msdata:IsDataSet=\"true\" msdata:MainDataTable=\"ErrorTable\" msdata:UseCurrentLocale=\"true\">\r\n      
            <xs:complexType>\r\n        
                <xs:choice minOccurs=\"0\" maxOccurs=\"unbounded\">\r\n          
                    <xs:element name=\"ErrorTable\">\r\n            
                        <xs:complexType>\r\n              
                            <xs:sequence>\r\n                
                                <xs:element name=\"accountnumber\" type=\"xs:string\" minOccurs=\"0\" />\r\n                
                                <xs:element name=\"CustomerID\" type=\"xs:string\" minOccurs=\"0\" />\r\n                
                                <xs:element name=\"name\" type=\"xs:string\" minOccurs=\"0\" />\r\n                
                                <xs:element name=\"EONERUNERRORS\" type=\"xs:string\" minOccurs=\"0\" />\r\n              
                            </xs:sequence>\r\n            
                        </xs:complexType>\r\n          
                    </xs:element>\r\n        
                </xs:choice>\r\n      
            </xs:complexType>\r\n    
        </xs:element>\r\n  
    </xs:schema>\r\n  
    <ErrorTable>\r\n    
        <accountnumber>C0008</accountnumber>\r\n    
        <CustomerID>IDs</CustomerID>\r\n    
        <name>Test Account 008</name>\r\n    
        <EONERUNERRORS>Document was not sent due to document errors.</EONERUNERRORS>\r\n  
    </ErrorTable>\r\n
    <ErrorTable>\r\n    
        <accountnumber>C0007</accountnumber>\r\n    
        <CustomerID>IDs</CustomerID>\r\n    
        <name>Test Account 007</name>\r\n    
        <EONERUNERRORS>Document was not sent due to document errors.</EONERUNERRORS>\r\n  
    </ErrorTable>\r\n
</NewDataSet>
```

This endpoint runs the specified process with the provided XML data table, and returns error messages.

### HTTP Request

`POST {{API Url}}/RunMapDataTableWithErrors?token={{Token}}&mapKey={{mapKey}}`

### Query Parameters

Parameter | Required | Description
--------- | ------- | -----------
token | true | Token generated by the GetToken endpoint
mapKey | true | Unique identifier for the process to retrieve


<aside class="warning">Currently this endpoint only returns the errors as an XML data table</aside>

## RunMapXml

> To run a specified process and provide Global Variables, use this code:

```shell
curl POST "{{API Url}}/RunMapXml?token={{Token}}&mapKey={{mapKey}}" \
  -H 'Content-Type: text/xml' \
  -H 'Accept: application/json' 
  -d '<RequestData xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
	      <Variables/>
	      <Xml>&lt;DataSet&gt;&#xD;
		      &lt;Table&gt;&#xD;
		        &lt;accountnumber&gt;C00070&lt;/accountnumber&gt;&#xD;
        	  &lt;name&gt;Test Account 001&lt;/name&gt;&#xD;
		      &lt;/Table&gt;&#xD;
		    &lt;/DataSet&gt;
	      </Xml>
      </RequestData>'
```

```python
import requests

url = "{{API Url}}/RunMapXml?token={{Token}}&mapKey={{mapKey}}"
headers = {
  'Content-Type': 'text/xml',
  'Accept': 'application/json'
}
payload = 
" <RequestData xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
	  <Variables/>
	  <Xml>&lt;DataSet&gt;&#xD;
		  &lt;Table&gt;&#xD;
		    &lt;accountnumber&gt;C00070&lt;/accountnumber&gt;&#xD;
    	  &lt;name&gt;Test Account 001&lt;/name&gt;&#xD;
		  &lt;/Table&gt;&#xD;
		&lt;/DataSet&gt;
	  </Xml>
  </RequestData>
"

response = requests.request("POST", url, headers=headers, data = payload)

print(response.text.encode('utf8'))
```

> The above command returns JSON structured like this:

```json
{
    "ErrorCount": 1,
    "Errors": "",
    "MapDescription": "Import of Purchase Journal",
    "MapKey": "364fde19-0748-4d10-886f-a95300a506c5",
    "MapId": "EXCEL TO BUSINESS CENTRAL PURCHASE JOURNAL",
    "RecordCount": 1,
    "RunNumber": 80,
    "Status": 1,
    "ErrorMessage": "Document was not sent due to document errors."
```

> The errors field will contain an XML Data Table:

```xml
<NewDataSet>\r\n  
    <xs:schema id=\"NewDataSet\"
        xmlns=\"\"
        xmlns:xs=\"http://www.w3.org/2001/XMLSchema\"
        xmlns:msdata=\"urn:schemas-microsoft-com:xml-msdata\">\r\n    
        <xs:element name=\"NewDataSet\" msdata:IsDataSet=\"true\" msdata:MainDataTable=\"ErrorTable\" msdata:UseCurrentLocale=\"true\">\r\n      
            <xs:complexType>\r\n        
                <xs:choice minOccurs=\"0\" maxOccurs=\"unbounded\">\r\n          
                    <xs:element name=\"ErrorTable\">\r\n            
                        <xs:complexType>\r\n              
                            <xs:sequence>\r\n                
                                <xs:element name=\"accountnumber\" type=\"xs:string\" minOccurs=\"0\" />\r\n                
                                <xs:element name=\"CustomerID\" type=\"xs:string\" minOccurs=\"0\" />\r\n                
                                <xs:element name=\"name\" type=\"xs:string\" minOccurs=\"0\" />\r\n                
                                <xs:element name=\"EONERUNERRORS\" type=\"xs:string\" minOccurs=\"0\" />\r\n              
                            </xs:sequence>\r\n            
                        </xs:complexType>\r\n          
                    </xs:element>\r\n        
                </xs:choice>\r\n      
            </xs:complexType>\r\n    
        </xs:element>\r\n  
    </xs:schema>\r\n  
    <ErrorTable>\r\n    
        <accountnumber>C0008</accountnumber>\r\n    
        <CustomerID>IDs</CustomerID>\r\n    
        <name>Test Account 008</name>\r\n    
        <EONERUNERRORS>Document was not sent due to document errors.</EONERUNERRORS>\r\n  
    </ErrorTable>\r\n
    <ErrorTable>\r\n    
        <accountnumber>C0007</accountnumber>\r\n    
        <CustomerID>IDs</CustomerID>\r\n    
        <name>Test Account 007</name>\r\n    
        <EONERUNERRORS>Document was not sent due to document errors.</EONERUNERRORS>\r\n  
    </ErrorTable>\r\n
</NewDataSet>
```

This endpoint runs the specified process with the provided XML encoded data table, and returns error messages.

### HTTP Request

`POST {{API Url}}/RunMapXml?token={{Token}}&mapKey={{mapKey}}`

### Query Parameters

Parameter | Required | Description
--------- | ------- | -----------
token | true | Token generated by the GetToken endpoint
mapKey | true | Unique identifier for the process to retrieve


<aside class="warning">Currently this endpoint only returns the errors as an XML data table</aside>