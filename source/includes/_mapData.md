# Map Data

The Map Data endpoints can be used to retrieve data from the data source defined in SmartConnect. If the data source is a query, a call will be made by SmartConnect to the source application for live data.

<aside class="warning">You will not be able to get data from real-time data source maps.</aside>

## GetAllData

This endpoint retrieves the current defined source for the specified process.

### HTTP Request

<div class="api-endpoint">
	<div class="endpoint-data">
		<i class="label label-post">POST</i>
		<h6>https://{{API_Url}}/GetAllData</h6>
	</div>
</div>

> To retrieve currently defined source data, use this code:

```shell
curl POST "{{API Url}}/GetAllData?token={{Token}}&mapKey={{mapKey}}" \
  -H 'Content-Type: application/json' \
  -H 'Accept: application/xml' 
```

```python
import requests

url = "{{API Url}}/GetAllData?token={{Token}}&mapKey={{mapKey}}"
headers = {
  'Content-Type': 'application/json',
  'Accept': 'application/xml'
}

response = requests.request("POST", url, headers=headers)

print(response.text.encode('utf8'))
```
```javascript
var xhr = new XMLHttpRequest();
xhr.open("POST", "{{API Url}}/GetAllData?token={{Token}}&mapKey={{mapKey}}");
xhr.setRequestHeader("Content-Type", "application/json");

xhr.send();
```

```csharp
System.Net.WebRequest request = System.Net.WebRequest.Create("{{API Url}}/GetAllData?token={{Token}}&mapKey={{mapKey}}");
request.Method = "POST";
request.ContentType = "application/json";

System.Net.WebResponse response = request.GetResponse();
string result = string.Empty;
using(System.IO.StreamReader responseStream = new System.IO.StreamReader(response.GetResponseStream()))
{
 string result = responseStream.ReadToEnd(); 
}

return result;
```

> The above command returns XML structured like this:

```xml
<string xmlns="http://schemas.microsoft.com/2003/10/Serialization/">&lt;MyDataSet&gt;&#xD;
  &lt;Table01&gt;&#xD;
    &lt;AccountNumber&gt;&lt;![CDATA[CUST001]]&gt;&lt;/AccountNumber&gt;&#xD;
    &lt;AccountName&gt;&lt;![CDATA[Purus Limited]]&gt;&lt;/AccountName&gt;&#xD;
    &lt;AddressCode&gt;&lt;![CDATA[Other]]&gt;&lt;/AddressCode&gt;&#xD;
    &lt;Address1&gt;&lt;![CDATA[373-1399 Ultrices St.]]&gt;&lt;/Address1&gt;&#xD;
    &lt;City&gt;&lt;![CDATA[Denver]]&gt;&lt;/City&gt;&#xD;
    &lt;State&gt;&lt;![CDATA[CO]]&gt;&lt;/State&gt;&#xD;
    &lt;ZIP&gt;&lt;![CDATA[92336]]&gt;&lt;/ZIP&gt;&#xD;
    &lt;Phone&gt;&lt;![CDATA[(303) 654-2228]]&gt;&lt;/Phone&gt;&#xD;
    &lt;Currency&gt;&lt;![CDATA[CAD$]]&gt;&lt;/Currency&gt;&#xD;
  &lt;/Table01&gt;&#xD;
&lt;/MyDataSet&gt;</string>
```
### Query Parameters

Parameter | Required | Description
--------- | ------- | -----------
token | true | Token generated by the GetToken endpoint
mapKey | true | Unique identifier for the process to retrieve


<aside class="warning">Currently this endpoint only returns data as XML</aside>

## GetAllDataWithVariables

This endpoint retrieves the current defined source for the specified process. If the data source is using Global Variables in the query, the values passed in the body will be applied as filters prior to retrieving the data.

For additional information about Global Variables reference [this article](https://www.eonesolutions.com/help-article/global-variables-in-smartconnect-com/).

### HTTP Request

<div class="api-endpoint">
	<div class="endpoint-data">
		<i class="label label-post">POST</i>
		<h6>https://{{API_Url}}/GetAllDataWithVariables</h6>
	</div>
</div>


> To retrieve currently defined source with Global Variable filters, use this code:

```shell
curl POST "{{API Url}}/GetAllDataWithVariables?token={{Token}}&mapKey={{mapKey}}" \
  -H 'Content-Type: application/json' \
  -H 'Accept: application/xml' \
  -d '{ 
      "Variables": "[ { Key: \"GBL_COUNTY\", Value: \"GA\" } ]", 
      "Xml": "" 
    }'
```

```python
import requests

url = "{{API Url}}/GetAllDataWithVariables?token={{Token}}&mapKey={{mapKey}}"
headers = {
  'Content-Type': 'application/json',
  'Accept': 'application/xml'
}
payload = 
{ 
  "Variables": "[ { Key: \"GBL_COUNTY\", Value: \"GA\" } ]", 
  "Xml": "" 
}

response = requests.request("POST", url, headers=headers, data = payload)

print(response.text.encode('utf8'))
```
```javascript
var data = "{ \r\n  \"Variables\": \"[ { Key: \\\"GBL_COUNTY\\\", Value: \\\"GA\\\" } ]\", \r\n  \"Xml\": \"\" \r\n}";
var xhr = new XMLHttpRequest();
xhr.open("POST", "{{API Url}}/GetAllDataWithVariables?token={{Token}}&mapKey={{mapKey}}");
xhr.setRequestHeader("Content-Type", "application/json");
xhr.setRequestHeader("Accept", "application/xml");

xhr.send(data);
```

```csharp
string data = "{ \r\n  \"Variables\": \"[ { Key: \\\"GBL_COUNTY\\\", Value: \\\"GA\\\" } ]\", \r\n  \"Xml\": \"\" \r\n}";
System.Net.WebRequest request = System.Net.WebRequest.Create("{{API Url}}/GetAllDataWithVariables?token={{Token}}&mapKey={{mapKey}}");
request.Method = "POST";
request.ContentType = "application/json";
request.ContentLength = data.Length;

using(Stream reqStream = request.GetRequestStream())
{
 reqStream.Write(Encoding.ASCII.GetBytes(xml),0,xml.Length);
}

System.Net.WebResponse response = request.GetResponse();
string result = string.Empty;
using(System.IO.StreamReader responseStream = new System.IO.StreamReader(response.GetResponseStream()))
{
 string result = responseStream.ReadToEnd(); 
}

return result;
```

> The above command returns XML structured like this:

```xml
<string xmlns="http://schemas.microsoft.com/2003/10/Serialization/">&lt;MyDataSet&gt;&#xD;
  &lt;Table01&gt;&#xD;
    &lt;AccountNumber&gt;&lt;![CDATA[CUST001]]&gt;&lt;/AccountNumber&gt;&#xD;
    &lt;AccountName&gt;&lt;![CDATA[Purus Limited]]&gt;&lt;/AccountName&gt;&#xD;
    &lt;AddressCode&gt;&lt;![CDATA[Other]]&gt;&lt;/AddressCode&gt;&#xD;
    &lt;Address1&gt;&lt;![CDATA[373-1399 Ultrices St.]]&gt;&lt;/Address1&gt;&#xD;
    &lt;City&gt;&lt;![CDATA[Denver]]&gt;&lt;/City&gt;&#xD;
    &lt;State&gt;&lt;![CDATA[CO]]&gt;&lt;/State&gt;&#xD;
    &lt;ZIP&gt;&lt;![CDATA[92336]]&gt;&lt;/ZIP&gt;&#xD;
    &lt;Phone&gt;&lt;![CDATA[(303) 654-2228]]&gt;&lt;/Phone&gt;&#xD;
    &lt;Currency&gt;&lt;![CDATA[CAD$]]&gt;&lt;/Currency&gt;&#xD;
  &lt;/Table01&gt;&#xD;
&lt;/MyDataSet&gt;</string>
```
### Query Parameters

Parameter | Required | Description
--------- | ------- | -----------
token | true | Token generated by the GetToken endpoint
mapKey | true | Unique identifier for the process to retrieve


<aside class="notice">Make sure the global variable is referenced in a script within the Process and as a filter criteria.</aside>


<aside class="warning">Currently this endpoint only returns data as XML</aside>
